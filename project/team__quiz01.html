<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>팀 퀴즈 프로젝트 Lv.1</title>
    <link rel="stylesheet" href="assets/css/quiz.css" />
    

    <style>


    </style>
</head>

<body>
    <main id="line__main">
        <div class="quiz__wrap">

        </div>
    </main>

    <script>
        const quizWrap = document.querySelector(".quiz__wrap");

        const quizInfo = [
            {
                question: "인터뷰에서 중꺾마(중요한 것은 꺾이지 않는 마음)를 처음으로 말 한 사람은?",
                choice: ["축구선수 박지성", "롤 데프트 선수", "롤 페이커 선수", "김연아"],
                answer: "2",
                desc:"리그 오브 레전드 2022 월드 챔피언십에 참가한 프로게임단 DRX 소속 프로게이머 김혁규(Deft) 선수의 인터뷰에서 유래된 유행어"
            },
            {
                question: "다음 중 '더글로리' 관련 유행어가 아닌 것은?",
                choice: ["멋지다 연진아", "넌 모르잖아? 알록달록한 세상", "무슨 악취 같은거 안나니?", "나 지금 되게 신나"],
                answer: "3",
                desc:"'무슨 악취 같은거 안나니?'는 마당이 있는집 유행어입니다"
            },
            {
                question: "다음 중 뉴진스와 관련있는 신조어가 아닌 것은?",
                choice: ["대퓨님", "꾸에엑", "디토합니다.", "엄마엄마가"],
                answer: "2",
                desc:"꾸에엑은 후회해를 의미하는 유행어입니다"
            },
            {
                question: "부장님이 내 보고서를 보며 퀄리티가 이게 뭐냐고 화를 낸다. 맥락에 맞는 신조어로 답을 해볼까?",
                choice: ["하지만 빨랐죠?", "우내할", "안익었는데진짜", "밈첩하다"],
                answer: "1",
                desc:"결과는 엉망이지만 하나만 콕 집어서 그 부분은 빠르게 넘긴 경우에 사용됩니다."
            },
            {
                question: "위 가수의 수 많은 별명들 사이에서의 진짜 활동명은?",
                choice: ["카더가든", "메이트리", "가터벨트", "킨더조이"],
                answer: "1",
                desc:"킨더조이 가터벨트 메이트리 칼든강도 가던말던 신미양요 등의 별명을 가지고 있습니다"
            },
            {
                question: "'내일 봬요 누나' (내봬누)가 나온 연애 프로그램은?",
                choice: ["나는솔로", "솔로지옥 시즌2", "환승연애 시즌2", "하트시그널 시즌3"],
                answer: "3",
                desc:"환승연애2의 출연자 간 솔직한 감정이 오고 가는 데이트와 술자리는 수많은 명장면과 명대사를 탄생시켰습니다."
            },
            {
                question: "신조어 '쿠쿠루삥뽕'을 사용할 수 있는 상황은?",
                choice: ["친구가 연인과 이별한 상황", "연인을 그윽하게 바라보는 상황", "맛있는 음식이 눈앞에 있는 상황", "친구와 내기에서 이긴 상황"],
                answer: "4",
                desc:"상대방을 놀릴 때 자주 하는 말입니다."
            },
            {
                question: "다음 중 '당모치'의 뜻으로 올바른 것은?",
                choice: ["당연히 모짜렐라 치즈가 최고", "당면이랑 모짜렐라 치즈 추가", "당근은 모두 치워버려", "당연히 모든 치킨은 옳다"],
                answer: "4",
                desc:"'당모치'는 당연히 모든 치킨은 옳다는 뜻의 줄임말입니다."
            },
            {
                question: "다음 중 'OO논쟁' 시리즈에 해당되는 것이 아닌 것은?",
                choice: ["블루투스논쟁", "에어팟 논쟁", "소주 논쟁", "새우 논쟁"],
                answer: "2",
                desc:"애인이 어떤 행동을 했을 때 어디까지 봐줄 수 있는지와 관련된 논쟁입니다."
            },
            {
                question: "<보기> 중 신조어의 뜻 풀이가 올바르지 않은 것을 모두 고르시오.",
                choice: ["ㄱ, ㄹ", "ㄴ", "ㄴ, ㄷ", "ㄱ, ㄷ, ㄹ"],
                answer: "1",
                desc:"'웃긴데 안 웃긴다'의 줄임말이다.어떤 상황을 접했을 때 헛웃음이 나오지만 마냥 우습거나 재미있지 않은 경우를 일컫는다"
            }
        ];

        let currentIndex = 0;
        let totalScore = 0;
        // let WrongNumber = 0;
        // let WrongNum = [];
        let desc = [];
        
        // let WrongNum;     // WrongNum를 전역 스코프에서 정의

        const updateQuiz = (index) => {
            let quizWrapTag = `<div class="quiz">
                <div class="quiz__header">
                    <div class="quiz__num">
                         <div class="this__level">Lv:1</div> 
                         <div class="this__round"><em>${index + 1}</em>/10</div>
                    </div>
                    <div class="question">
                        <div class="title">   
                            <h1><em>Q${index + 1}.</em> ${quizInfo[index].question}</h1>
                        </div>
                        <div class="img">
                            <img src="assets/img/quiz${index+1}.jpg" alt="퀴즈01이미지">
                        </div>
                    </div>
                </div>
                <div class="quiz__choice">
                    <label for="choice1-${quizInfo[index].choice[0]}">
                        <input type="radio" id="choice1-${quizInfo[index].choice[0]}" name="choice" value="1">
                        <span>${quizInfo[index].choice[0]}</span>
                    </label>
                    <label for="choice2-${quizInfo[index].choice[1]}">
                        <input type="radio" id="choice2-${quizInfo[index].choice[1]}" name="choice" value="2">
                        <span>${quizInfo[index].choice[1]}</span>
                    </label>
                    <label for="choice3-${quizInfo[index].choice[2]}">
                        <input type="radio" id="choice3-${quizInfo[index].choice[2]}" name="choice" value="3">
                        <span>${quizInfo[index].choice[2]}</span>
                    </label>
                    <label for="choice4-${quizInfo[index].choice[3]}">
                        <input type="radio" id="choice4-${quizInfo[index].choice[3]}" name="choice" value="4">
                        <span>${quizInfo[index].choice[3]}</span>
                    </label>
                </div>
            </div>`;
            quizWrap.innerHTML = quizWrapTag;
            
            // 인풋 값이 네 개이기 때문에 각 버튼마다 클릭이벤트를 적용시켜주어야 한다.
            // 버튼눌러서 정답 확인

            // 버튼 클릭 이벤트 리스너에서 사용자의 답변을 저장
            const userAnswers = [];
            const buttons = quizWrap.querySelectorAll(".quiz__choice input");
            buttons.forEach((btn) => {
                btn.addEventListener("click", () => {
                    const selectedChoice = quizWrap.querySelectorAll("input[name='choice']:checked");

                    if (selectedChoice.length > 0) {
                        const userAnswer = selectedChoice[0].value;
                        userAnswers[index] = userAnswer; // 사용자의 답변을 배열에 저장
                        if(userAnswer == quizInfo[index].answer){
                            
                            totalScore += 10;
                        } else {
                            // WrongNum.push(index + 1);
                            // console.log(WrongNumber)    // 확인


                            // 틀린 문제 설명을 배열에 추가(여러개일 수 있기 때문에 배열에 저장해야 함)
                            desc.push(index + 1 + "번 : " +quizInfo[index].desc);
                        };
                    }
                    console.log(desc)   // 함수 밖에서도 작동되는지 확인
                    // console.log(WrongNum)




                    // 다음 문제 넘어가기 
                    currentIndex++;
                    if(currentIndex < quizInfo.length){
                        updateQuiz(currentIndex);
                    } else if(currentIndex >= quizInfo.length) {
                        alert("모든 문제를 풀었습니다.");
                        
                        // 한번 더 변수에 저장해서 가져와야 함 
                        const userScore = totalScore;


                        // URL 매개변수를 조작하기 위해 URLSearchParams를 사용
                        const urlParams = new URLSearchParams(window.location.search);

                        // 사용자의 틀린 문제 번호와 설명을 URL에 추가
                        urlParams.set('userScore', totalScore);
                        
                        // 배열로 저장한 desc를 map()함수를 이용해서 URL 매개변수에 추가(url은 문자열로만 값을 저장하므로 배열 형태로 저장하면 문제 생김)
                        // urlParams.set('WrongNum', WrongNum.map(item => item).join(','));
                        urlParams.set('desc', desc.map(item => item).join(','));

                        // age와 name 매개변수 값을 추출합니다.
                        const age = urlParams.get('age');
                        const name = urlParams.get('name');

                        urlParams.set('age', age);
                        urlParams.set('name', name);


                        // 데이터를 활용하여 필요한 작업을 수행합니다.
                        console.log(`나이대: ${age}`);
                        console.log(`이름: ${name}`);

                        // 다음 페이지로 이동하면서 URL 매개변수를 그대로 전달합니다.
                        const nextPageUrl = `grade01.html?${urlParams.toString()}`;
                        window.location.href = nextPageUrl;
                    };
            
                });
            });

        };


        document.addEventListener("DOMContentLoaded", () => {
            updateQuiz(currentIndex);   
        })
            
        
    </script>
</body>

</html>